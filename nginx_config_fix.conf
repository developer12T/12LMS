# Handle static assets for 12LMS with proper MIME types
location ^~ /12lms/assets/ {
    alias /var/www/12LMS/dist/assets/;
    try_files $uri =404;
    
    # Set proper MIME types for different file types
    location ~* \.css$ {
        add_header Content-Type text/css;
        expires 1y;
        add_header Cache-Control "public, immutable";
    }
    
    location ~* \.js$ {
        add_header Content-Type application/javascript;
        expires 1y;
        add_header Cache-Control "public, immutable";
    }
    
    location ~* \.mjs$ {
        add_header Content-Type application/javascript;
        expires 1y;
        add_header Cache-Control "public, immutable";
    }
    
    location ~* \.(png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$ {
        expires 1y;
        add_header Cache-Control "public, immutable";
    }
}

# Handle favicon
location ^~ /12lms/favicon.ico {
    alias /var/www/12LMS/dist/favicon.ico;
    try_files $uri =404;
}

# Handle exact /12lms (without trailing slash) - redirect to with slash
location = /12lms {
    return 301 /12lms/;
}

# Main Vue 3 App at /12lms/
location /12lms/ {
    alias /var/www/12LMS/dist/;
    index index.html;
    
    # First try to serve request as file, then as directory, 
    # then fall back to index.html for Vue Router
    try_files $uri $uri/ /12lms/index.html;
    
    # Set proper MIME type for HTML files
    location ~* \.html$ {
        add_header Content-Type text/html;
    }
} 